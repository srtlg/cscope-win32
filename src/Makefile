# created from autogenerated Makefile
RX = ../rxspencer
CURSES= ../pdcurses
LEX = flex
YACC = bison -y

#----------------------
CC = gcc
LD = $(CC)
SOURCES = fscanner.l egrep.y alloc.c basename.c build.c build.h command.c compath.c constants.h crossref.c dir.c 	display.c edit.c exec.c find.c global.h help.c history.c input.c 	invlib.c invlib.h library.h logdir.c lookup.c lookup.h main.c mouse.c mygetenv.c mypopen.c scanner.h version.h vp.h vpaccess.c vpfopen.c vpinit.c vpopen.c
CLEANFILES = fscanner.c egrep.c
CONFIG_HEADER = config.h
PROGRAM = cscope.exe

ifeq ($(DEBUG),Y)
CFLAGS = -O0 -g
else
CFLAGS = -O2
endif
CFLAGS += -DHAVE_CONFIG_H -DWIN32 -I. -I$(RX) -I$(CURSES)
LDFLAGS = $(CURSES)/wincon/pdcurses.a $(RX)/rxspencer.a

OBJECTS =  fscanner.o egrep.o alloc.o basename.o \
build.o command.o compath.o crossref.o dir.o display.o \
edit.o exec.o find.o help.o history.o input.o invlib.o \
logdir.o lookup.o main.o mouse.o mygetenv.o mypopen.o \
w32utils.o vpaccess.o vpfopen.o vpinit.o vpopen.o

.SUFFIXES:
.SUFFIXES: .c .l .o .y

all: $(PROGRAM)

.c.o:
	$(CC) -c $(CFLAGS) $<

$(PROGRAM): $(OBJECTS)
	$(LD) $(OBJECTS) $(LDFLAGS) -o $(PROGRAM)
.l.c:
	$(LEX) -o$*.c $*.l
.y.c:
	$(YACC) -o$*.c $*.y
egrep.h: egrep.c

alloc.o: alloc.c library.h global.h config.h constants.h invlib.h
basename.o: basename.c global.h config.h constants.h invlib.h \
	library.h
build.o: build.c build.h global.h config.h constants.h invlib.h \
	library.h scanner.h version.h vp.h  w32utils.h
command.o: command.c global.h config.h constants.h invlib.h library.h \
	build.h w32utils.h
compath.o: compath.c global.h config.h constants.h invlib.h library.h w32utils.h
crossref.o: crossref.c global.h config.h constants.h invlib.h \
	library.h build.h scanner.h  w32utils.h
dir.o: dir.c global.h config.h constants.h invlib.h library.h vp.h w32utils.h
display.o: display.c global.h config.h constants.h invlib.h library.h \
	build.h version.h w32utils.h
edit.o: edit.c global.h config.h constants.h invlib.h library.h
egrep.o: egrep.c global.h config.h constants.h invlib.h library.h
exec.o: exec.c global.h config.h constants.h invlib.h library.h
find.o: find.c global.h config.h constants.h invlib.h library.h \
	build.h scanner.h w32utils.h
fscanner.o: fscanner.c global.h config.h constants.h invlib.h \
	library.h scanner.h lookup.h
help.o: help.c global.h config.h constants.h invlib.h library.h
history.o: history.c global.h config.h constants.h invlib.h library.h
input.o: input.c global.h config.h constants.h invlib.h library.h
invlib.o: invlib.c invlib.h global.h config.h constants.h library.h
logdir.o: logdir.c global.h config.h constants.h invlib.h library.h
lookup.o: lookup.c global.h config.h constants.h invlib.h library.h \
	lookup.h
main.o: main.c global.h config.h constants.h invlib.h library.h \
	build.h vp.h version.h scanner.h
mouse.o: mouse.c global.h config.h constants.h invlib.h library.h
mygetenv.o: mygetenv.c library.h
mypopen.o: mypopen.c global.h config.h constants.h invlib.h library.h
w32utils.o: w32utils.h w32utils.c alloc.h
vpaccess.o: vpaccess.c vp.h config.h
vpfopen.o: vpfopen.c vp.h config.h global.h constants.h invlib.h \
	library.h
vpinit.o: vpinit.c vp.h config.h library.h global.h constants.h \
	invlib.h
vpopen.o: vpopen.c global.h config.h constants.h invlib.h library.h \
	vp.h

clean:
	$(ComSpec) /c del $(OBJECTS) fscanner.c egrep.c $(PROGRAM)

dist:	$(PROGRAM)
	strip cscope.exe
	7z.exe a -tzip -mx=9 cscope.zip $(PROGRAM) sort.exe
